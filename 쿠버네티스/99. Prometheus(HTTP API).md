# Prometheus HTTP API

| origin_ |      |
| ------- | ---- |
|         |      |

```
origin_prometheus	
label_values(origin_prometheus)

Node	label_values(kube_node_info{origin_prometheus=~"$origin_prometheus"},node)
-> kube_node_info 조회 중 node 레이블 


NameSpace	label_values(kube_namespace_labels{origin_prometheus=~"$origin_prometheus"},namespace)

Container
label_values(kube_pod_container_info{origin_prometheus=~"$origin_prometheus",namespace=~"$NameSpace"},container)

Pod
label_values(kube_pod_container_info{origin_prometheus=~"$origin_prometheus",namespace=~"$NameSpace",container=~"$Container"},pod)
```



Api server 관련 수집  Metric 정보

https://docs.signalfx.com/en/latest/integrations/agent/monitors/kubernetes-apiserver.html

Node 정보

https://docs.signalfx.com/en/latest/integrations/agent/monitors/prometheus-node.html



**Latency:** Latency can be extracted from the `apiserver_request_duration_seconds` histogram buckets:

**Request rate:** The metric ***apiserver_request_total\*** can be used to monitor the requests to the service, from where they are coming, to which service, which action and whether they were successful:

```

```



---

cpu(%) 과정 (그라파나 대시보드에서)

```
namespace: pod kube_pod_labels{cluster="cluster1"}
-> kube-system, default, local-path-storage
```

```
pod: kube_pod_info{namespace="kube-system, default, local-path-storage"}
-> prometheus-kube-state-metrics-5786c7446c-cnprd
```

```
sum(rate(container_cpu_usage_seconds_total{pod="prometheus-kube-state-metrics-5786c7446c-cnprd"}[5m]))
-> Pod 정보 얻기 
```

```
sum by(pod) (rate(container_cpu_usage_seconds_total[5m]))
```



Pod 중 prometheus-kube-state-metrics-5786c7446c-cnprd 를 얻는다. 조사 필요

```
sum by(pod) (rate(container_cpu_usage_seconds_total[5m]))
```



---

inode 구하는 방법 참고 

https://www.robustperception.io/filesystem-metrics-from-the-node-exporter